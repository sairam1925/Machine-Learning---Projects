{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "ea1f0943-267a-405e-bcf2-b181daa35b29",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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OnjwoCZPnixJioiIkJeXl9555x09+uij1n4nT57Uxo0b9cgjj5gev1mzZnrhhRe0cuVKffnll3bXdS3NmzdX3bp19d5772n8+PHW9pycHO3YsUOBgYEVPvbJkyd19uxZ6+MJqlevru7du2vPnj1q27at3N3d7TrOHXfcoUceeUSnTp3SuHHjdOzYMbVq1arMqlh5XA1Krq6uSkxMVGlpqV555ZVyHwe41QhJQBU1depUubi4aMqUKTIMQ+np6dcMSq6urpo1a5YeeughSf+7NuZ6Bg8erJdfflnr16+v1LqvWrZsmR544AHFxMRo5MiRiomJ0Z133qnc3Fx98MEHSk9PV1ZWVrlCUvPmzfXkk09q0aJFcnFxUUxMjI4dO6YpU6YoKChIzz77rKSfvvinTJmiSZMmaejQoRo8eLDOnTun6dOny9PTU9OmTZMk7du3T08//bQeffRRNW3aVO7u7tq4caP27dun559//qbnwMXFRdOnT9ef/vQnPfLIIxo5cqTy8/M1ffp01atXTy4u9l0RcfHiRev1RCUlJTp69Kj1QaLjxo2z9luwYIHuueceRUVFafTo0WrUqJGKior0zTff6IMPPtDGjRslSX379lVoaKjCwsLk5+en48ePa/78+QoODlbTpk0lyfroiQULFmjYsGGqVq2amjdvrlq1atlVs8ViUVJSkiwWi+bNmyfDMDRv3jy79gVuG8deNw7AHte7w+yll14yJBkPP/ywcenSJZu7234pMjLSkHTdu9t+7uOPP7bekVSZd7dddfHiRWPhwoVGRESE4e3tbbi5uRmBgYHGww8/bHz44YfWftf6/Js2bTIkGZs2bbK2lZSUGH/961+NZs2aGdWqVTN8fX2NIUOGGCdOnCgz/ptvvmm0bdvWcHd3N3x8fIzf//73xldffWV9/7vvvjOGDx9utGjRwqhRo4ZRs2ZNo23btsa8efNs7lq71t1tc+fOLTOmJGPatGk2bUlJScbvfvc7w93d3WjWrJnx1ltvGb///e+Ndu3a3XAOf3l3m4uLixEYGGjExMQYmzdvLtP/6NGjxsiRI4369esb1apVM/z8/IzIyEhj5syZ1j6JiYlGZGSk4evra7i7uxsNGzY0YmNjjWPHjtkca+LEiUZgYKDh4uJS5t/hl671d1laWmq923HMmDE3/LzA7WQxjFtwCwoAoMLy8/PVrFkz9e/fX0lJSY4uB/jN4nQbADhQXl6eXnrpJXXv3l116tTR8ePHNW/ePBUVFWns2LGOLg/4TSMkAYADeXh46NixY3rqqad0/vx5Va9eXeHh4Xr99dfVunVrR5cH/KZxug0AAMAED5MEAAAwQUgCAAAwQUgCAAAwwYXbFVRaWqrTp0+rVq1aslgsji4HAADYwTAMFRUVKTAw8IYPbCUkVdDp06cVFBTk6DIAAEAFnDhxosxvPP4SIamCrj56/8SJE/L29nZwNQAAwB6FhYUKCgqy6yd0CEkVdPUUm7e3NyEJAIAqxp5LZbhwGwAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwAQhCQAAwITDQ9LixYsVEhIiT09PdejQQdu2bbtm31WrVik6Olp+fn7y9vZWRESENmzYUKZffn6+4uLiVK9ePXl6eqply5Zat25dhccFAAC/PQ4NSRkZGRo3bpwmT56sPXv2KCoqSjExMcrJyTHtv3XrVkVHR2vdunXKyspS9+7d1bdvX+3Zs8fa59KlS4qOjtaxY8f097//XYcOHVJycrLq169f4XEBAMBvj8UwDMNRg3fu3Fnt27fXkiVLrG0tW7ZU//79lZCQYNcxWrdurYEDB2rq1KmSpNdff11z587Vv//9b1WrVu2WjVtYWCgfHx8VFBTI29vbrn0AAIBjlef722ErSZcuXVJWVpZ69epl096rVy/t2LHDrmOUlpaqqKhItWvXtratXbtWERERiouLU0BAgEJDQzVr1iyVlJRU2rgAAODXz81RA589e1YlJSUKCAiwaQ8ICFBeXp5dx0hMTNSFCxc0YMAAa9uRI0e0ceNGPfbYY1q3bp0OHz6suLg4XblyRVOnTq3wuMXFxSouLra+LiwstKtGAABQNTn8wm2LxWLz2jCMMm1m0tPTFR8fr4yMDPn7+1vbS0tL5e/vr6SkJHXo0EGDBg3S5MmTbU6tVWTchIQE+fj4WLegoCB7Ph4AAKiiHBaSfH195erqWmb15syZM2VWeX4pIyNDsbGxeu+999SzZ0+b9+rVq6dmzZrJ1dXV2tayZUvl5eXp0qVLFR534sSJKigosG4nTpyw96MCAIAqyGEhyd3dXR06dFBmZqZNe2ZmpiIjI6+5X3p6uoYPH660tDT16dOnzPtdunTRN998o9LSUmvb119/rXr16snd3b3C43p4eMjb29tmAwAAv14OPd02fvx4vfnmm3rrrbd08OBBPfvss8rJydGoUaMk/bR6M3ToUGv/9PR0DR06VImJiQoPD1deXp7y8vJUUFBg7TN69GidO3dOY8eO1ddff60PP/xQs2bNUlxcnN3jAgAAOOzCbUkaOHCgzp07pxkzZig3N1ehoaFat26dgoODJUm5ubk2zy564403dOXKFcXFxdmEnmHDhik1NVWSFBQUpI8//ljPPvus2rZtq/r162vs2LGaMGGC3eMCAAA49DlJVRnPSQIAoOqpEs9JAgAAcGaEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABOEJAAAABMOD0mLFy9WSEiIPD091aFDB23btu2afVetWqXo6Gj5+fnJ29tbERER2rBhg02f1NRUWSyWMtuPP/5o7RMfH1/m/bp1696yzwgAAKoeh4akjIwMjRs3TpMnT9aePXsUFRWlmJgY5eTkmPbfunWroqOjtW7dOmVlZal79+7q27ev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VVRUpNq1a9u0z5gxQ35+foqNjb3mvocPH1ZgYKBCQkI0aNAgHTly5LpjFRcXq7Cw0GYDAAC/Xg4LSWfPnlVJSYkCAgJs2gMCApSXl2fXMRITE3XhwgUNGDDA2vbPf/5TS5cuVXJy8jX369y5s5YtW6YNGzYoOTlZeXl5ioyM1Llz5665T0JCgnx8fKxbUFCQXTUCAICqyeEXblssFpvXhmGUaTOTnp6u+Ph4ZWRkyN/fX5JUVFSkIUOGKDk5Wb6+vtfcNyYmRn/4wx/Upk0b9ezZUx9++KEk6e23377mPhMnTlRBQYF1O3HihD0fDwAAVFFujhrY19dXrq6uZVaNzpw5U2Z16ZcyMjIUGxurFStWqGfPntb2b7/9VseOHVPfvn2tbaWlpZIkNzc3HTp0SE2aNClzvBo1aqhNmzY6fPjwNcf08PCQh4eHXZ8NAABUfQ5bSXJ3d1eHDh2UmZlp056ZmanIyMhr7peenq7hw4crLS1Nffr0sXmvRYsW2r9/v7Kzs61bv3791L17d2VnZ1/zFFlxcbEOHjyoevXq3fwHAwAAvwoOW0mSpPHjx+vxxx9XWFiYIiIilJSUpJycHI0aNUrST6e4Tp06pWXLlkn6KSANHTpUCxYsUHh4uHUVysvLSz4+PvL09FRoaKjNGHfccYck2bQ/99xz6tu3rxo2bKgzZ85o5syZKiws1LBhw27DpwYAAFWBQ0PSwIEDde7cOc2YMUO5ubkKDQ3VunXrFBwcLEnKzc21eWbSG2+8oStXriguLk5xcXHW9mHDhik1NdXucU+ePKnBgwfr7Nmz8vPzU3h4uHbu3GkdFwAAwKHPSarKeE4SAABVT5V4ThIAAIAzIyQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQBAACYICQB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",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "#Load dataset\n",
    "dataset = pd.read_csv(\"supermarket_customers.csv\")\n",
    "\n",
    "x = dataset.iloc[:, :-1].values\n",
    "y = dataset.iloc[:, -1].values\n",
    "\n",
    "#Train-test split\n",
    "from sklearn.model_selection import train_test_split\n",
    "x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.25, random_state=0)\n",
    "\n",
    "#Scaling (important even for 0/1 values)\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "sc = StandardScaler()\n",
    "x_train = sc.fit_transform(x_train)\n",
    "x_test = sc.transform(x_test)\n",
    "\n",
    "#K tuning\n",
    "from sklearn.neighbors import KNeighborsClassifier\n",
    "from sklearn.metrics import accuracy_score\n",
    "\n",
    "accuracy_list = []\n",
    "k_values = range(1, 8)\n",
    "\n",
    "for k in k_values:\n",
    "    knn = KNeighborsClassifier(n_neighbors=k)\n",
    "    knn.fit(x_train, y_train)\n",
    "    y_pred = knn.predict(x_test)\n",
    "    accuracy_list.append(accuracy_score(y_test, y_pred))\n",
    "\n",
    "#plot\n",
    "plt.plot(k_values, accuracy_list, marker='o')\n",
    "plt.xlabel(\"k Value\")\n",
    "plt.ylabel(\"Accuracy\")\n",
    "plt.title(\"KNN - Choosing Best K\")\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "3d12f4c0-887f-44e5-8cf2-d882a11931a2",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Best K: 1\n"
     ]
    }
   ],
   "source": [
    "best_k = k_values[np.argmax(accuracy_list)]\n",
    "print(\"Best K:\", best_k)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "d6f1314d-8894-4da2-9dc2-75568d0e499e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   Actual  Predicted\n",
      "0       0          0\n",
      "1       1          2\n",
      "2       1          0\n",
      "3       1          0\n"
     ]
    }
   ],
   "source": [
    "knn_final = KNeighborsClassifier(n_neighbors=best_k)\n",
    "knn_final.fit(x_train, y_train)\n",
    "\n",
    "y_pred = knn_final.predict(x_test)\n",
    "\n",
    "df = pd.DataFrame({'Actual': y_test, 'Predicted': y_pred})\n",
    "print(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "dee7c41d-fb3a-4eec-8008-a014c5279b08",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "KNN model and scaler saved successfully!\n"
     ]
    }
   ],
   "source": [
    "import joblib\n",
    "\n",
    "joblib.dump(knn_final, \"knn_customer_model.pkl\")\n",
    "joblib.dump(sc, \"scaler.pkl\")\n",
    "\n",
    "print(\"KNN model and scaler saved successfully!\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3984fead-b19e-4076-9f43-7538319eb469",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
